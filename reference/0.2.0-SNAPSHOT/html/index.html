<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Authors: The YAKS Community">
<title>YAKS</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />

<style>

    h1, h2, h3, h4, h5, h6, #toctitle {
        color: #3b73af;
    }

    div#toctitle {
        content: url("images/yaks-logo-toc.png");
    }

    #content h1>a.link, h2>a.link, h3>a.link, #toctitle>a.link, .sidebarblock>.content>.title>a.link, h4>a.link, h5>a.link, h6>a.link {
      color: #3b73af;
      text-decoration: none;
    }

    #content h1>a.link:hover, h2>a.link:hover, h3>a.link:hover, #toctitle>a.link:hover, .sidebarblock>.content>.title>a.link:hover, h4>a.link:hover, h5>a.link:hover, h6>a.link:hover {
      color: #3b73af;
    }

</style>
</head>
<body id="yaks" class="book toc2 toc-left">
<div id="header">
<h1>YAKS</h1>
<div class="details">
<span id="author" class="author">Authors: The YAKS Community</span><br>
<span id="revnumber">version 0.2.0-SNAPSHOT,</span>
<span id="revdate">2020-11-27</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">yaks</div>
<ul class="sectlevel1">
<li><a href="#preface">1. What is YAKS!?</a></li>
<li><a href="#quickstart">2. Getting started</a></li>
<li><a href="#installation">3. Installation</a>
<ul class="sectlevel2">
<li><a href="#installation-requirements">3.1. Requirements</a></li>
<li><a href="#installation-windows">3.2. Windows prerequisite</a></li>
<li><a href="#installation-operator">3.3. Operator install</a>
<ul class="sectlevel3">
<li><a href="#installation-global-mode">3.3.1. Global mode</a></li>
<li><a href="#installation-namespaced-mode">3.3.2. Namespaced mode</a></li>
</ul>
</li>
<li><a href="#installation-verify">3.4. Verify installation</a></li>
</ul>
</li>
<li><a href="#running">4. Running</a>
<ul class="sectlevel2">
<li><a href="#running-monitoring">4.1. Status monitoring</a></li>
</ul>
</li>
<li><a href="#cli">5. Command line interface (yaks)</a>
<ul class="sectlevel2">
<li><a href="#available-commands">5.1. Available Commands</a></li>
</ul>
</li>
<li><a href="#configuration">6. Configuration</a>
<ul class="sectlevel2">
<li><a href="#configuration-dependencies">6.1. Runtime dependencies</a>
<ul class="sectlevel3">
<li><a href="#configuration-tags">6.1.1. Cucumber tags</a></li>
<li><a href="#configuration-properties">6.1.2. System property or environment setting</a></li>
<li><a href="#configuration-properties-file">6.1.3. Property file</a></li>
<li><a href="#configuration-file">6.1.4. YAKS configuration file</a></li>
</ul>
</li>
<li><a href="#configuration-repositories">6.2. Maven repositories</a>
<ul class="sectlevel3">
<li><a href="#configuration-repository-properties">6.2.1. System property or environment setting</a></li>
<li><a href="#configuration-repository-file">6.2.2. Property file</a></li>
<li><a href="#configuration-repository-config">6.2.3. YAKS configuration file</a></li>
</ul>
</li>
<li><a href="#configuration-secrets">6.3. Using secrets</a></li>
</ul>
</li>
<li><a href="#steps">7. Steps</a>
<ul class="sectlevel2">
<li><a href="#steps-standard">7.1. Standard steps</a>
<ul class="sectlevel3">
<li><a href="#steps-variables">7.1.1. Variable steps</a></li>
<li><a href="#steps-log">7.1.2. Log steps</a></li>
<li><a href="#steps-sleep">7.1.3. Sleep</a></li>
</ul>
</li>
<li><a href="#steps-camel">7.2. Apache Camel steps</a></li>
<li><a href="#steps-camel-k">7.3. Apache Camel K steps</a></li>
<li><a href="#steps-groovy">7.4. Groovy steps</a>
<ul class="sectlevel3">
<li><a href="#groovy-configuration-script">7.4.1. Framework configuration</a></li>
<li><a href="#groovy-endpoint-script">7.4.2. Endpoint configuration</a></li>
<li><a href="#groovy-action-script">7.4.3. Test actions</a></li>
</ul>
</li>
<li><a href="#steps-http">7.5. Http steps</a></li>
<li><a href="#steps-jdbc">7.6. JDBC steps</a></li>
<li><a href="#steps-jms">7.7. JMS steps</a></li>
<li><a href="#steps-kafka">7.8. Kafka steps</a></li>
<li><a href="#steps-kubernetes">7.9. Kubernetes steps</a></li>
<li><a href="#steps-knative">7.10. Knative steps</a></li>
<li><a href="#steps-openapi">7.11. Open API steps</a></li>
</ul>
</li>
<li><a href="#extensions">8. Extensions</a>
<ul class="sectlevel2">
<li><a href="#extensions-minio">8.1. Minio upload</a></li>
<li><a href="#extensions-jitpack">8.2. Jitpack extensions</a></li>
</ul>
</li>
<li><a href="#pre-post-scripts">9. Pre/Post scripts</a></li>
<li><a href="#reports">10. Reporting</a></li>
<li><a href="#contributing">11. Contributing</a></li>
<li><a href="#uninstall">12. Uninstall</a></li>
<li><a href="#samples">13. Samples</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Version: 0.2.0-SNAPSHOT</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/yaks-logo.png" alt="yaks-logo">
</div>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="preface"><a class="anchor" href="#preface"></a><a class="link" href="#preface">1. What is YAKS!?</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>YAKS is a framework to enable Cloud Native BDD testing on Kubernetes! Cloud Native here means that your tests execute
as Kubernetes PODs.</p>
</div>
<div class="paragraph">
<p>As a user you can run tests by creating a <code>Test</code> custom resource on your favorite Kubernetes based cloud provider.
Once the YAKS operator is installed it will listen for custom resources and automatically prepare a test runtime
that runs the test as part of the cloud infrastructure.</p>
</div>
<div class="paragraph">
<p>Tests in YAKS follow the BDD (Behavior Driven Development) concept and represent feature specifications written
in <a href="https://cucumber.io/docs/gherkin/">Gherkin</a> syntax.</p>
</div>
<div class="paragraph">
<p>As a framework YAKS provides a set of predefined <a href="https://cucumber.io/">Cucumber</a> steps which help you to connect with different
messaging transports (Http REST, JMS, Kafka, Knative eventing) and verify message data with assertions on the header and body content.</p>
</div>
<div class="paragraph">
<p>YAKS adds its functionality on top of on <a href="https://citrusframework.org">Citrus</a> for connecting to different endpoints as a client
and/or server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quickstart"><a class="anchor" href="#quickstart"></a><a class="link" href="#quickstart">2. Getting started</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Assuming you have a Kubernetes playground and that you are connected to a namespace on that cluster
just write a <code>helloworld.feature</code> BDD file with the following content:</p>
</div>
<div class="listingblock">
<div class="title">helloworld.feature</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Feature: Hello

  Scenario: Print hello message
    Given print 'Hello from YAKS!'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then execute the following command using the <a href="https://github.com/citrusframework/yaks/releases/">YAKS CLI tool</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test helloworld.feature</code></pre>
</div>
</div>
<div class="paragraph">
<p>This runs the test immediately on the current namespace in your connected Kubernetes cluster.
Nothing else is needed.</p>
</div>
<div class="paragraph">
<p>Continue reading the documentation and learn how to install and get started working with YAKS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a><a class="link" href="#installation">3. Installation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>YAKS directly runs the test as part of a cloud infrastructure by leveraging the <a href="https://sdk.operatorframework.io/">Operator SDK</a>
and the concept of custom resources in Kubernetes.</p>
</div>
<div class="paragraph">
<p>As a user you need to enable YAKS on your infrastructure by installing the operator and creating the required custom resources and roles.</p>
</div>
<div class="sect2">
<h3 id="installation-requirements"><a class="anchor" href="#installation-requirements"></a><a class="link" href="#installation-requirements">3.1. Requirements</a></h3>
<div class="paragraph">
<p>You need access to a Kubernetes or Openshift cluster in order to use YAKS. You have different options
to setup/use a Kubernetes or OpenShift cluster.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://minikube.sigs.k8s.io/docs/start/">Minikube</a></p>
</li>
<li>
<p><a href="https://docs.okd.io/3.11/minishift/getting-started/index.html">Minishift</a></p>
</li>
<li>
<p><a href="https://code-ready.github.io/crc/">Red Hat CodeReady Containers (CRC)</a></p>
</li>
<li>
<p><a href="https://console.cloud.google.com/">Google Kubernetes Engine (GKE)</a></p>
</li>
<li>
<p><a href="https://cloud.redhat.com/">OpenShift</a></p>
</li>
<li>
<p><a href="https://cloud.ibm.com/">IBM Kubernetes Service (IKS)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Obviously the cluster will be the place where the tests will be executed and probably also the place where to run the SUT (System Under Test).</p>
</div>
<div class="paragraph">
<p>For setting up roles and custom resources you may need to have administrative rights on that cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="installation-windows"><a class="anchor" href="#installation-windows"></a><a class="link" href="#installation-windows">3.2. Windows prerequisite</a></h3>
<div class="paragraph">
<p>For full support of Yaks on Windows please enable "Windows Subsystem for Linux". You can do it manually by heading to Control Panel &gt; Programs &gt; Turn
Windows Features On or Off and checking "Windows Subsystem for Linux". Or you can simply execute this command in powershell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</code></pre>
</div>
</div>
<div class="paragraph">
<p>This action requires a full reboot of the system.</p>
</div>
</div>
<div class="sect2">
<h3 id="installation-operator"><a class="anchor" href="#installation-operator"></a><a class="link" href="#installation-operator">3.3. Operator install</a></h3>
<div class="paragraph">
<p>The YAKS operator will listen for new test resources in order to run those on the cloud infrastructure.
The operators is in charge of preparing a proper runtime for each test and it will reconcile the status of a test.</p>
</div>
<div class="paragraph">
<p>The easiest way to getting started with the YAKS operator installation is to use the <strong>YAKS CLI</strong>.
You can download the CLI from the <a href="https://github.com/citrusframework/yaks/releases/">release page</a> where you will find installation
archives for different operating systems.</p>
</div>
<div class="paragraph">
<p>Download and decompress the archive. The archive holds a binary that will help you to install YAKS and run the tests.
To install the <code>yaks</code> binary, just make it runnable and move it to a location in your <code>$PATH</code>, e.g. on linux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script"># Make executable and move to usr/local/bin
$ chmod a+x yaks-${project.version}-linux-64bit
$ mv yaks-${project.version}-linux-64bit /usr/local/bin/yaks

# Alternatively, set a symbolic link to "yaks"
$ mv yaks-${project.version}-linux-64bit yaks
$ ln -s $(pwd)/yaks /usr/local/bin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you have the <code>yaks</code> CLI available, log into your cluster using the
standard <code>oc</code> (OpenShift) or <code>kubectl</code> (Kubernetes) client tool.</p>
</div>
<div class="paragraph">
<p>Once you are properly connected to your cluster execute the following command to install YAKS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will install and run the YAKS operator in the current namespace.</p>
</div>
<div class="paragraph">
<p>You can specify the target namespace where to run the operator with a <code>--namespace</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks install -n kube-operators</code></pre>
</div>
</div>
<div class="paragraph">
<p>The namespace must available on the cluster before running the install command. If the namespace has not
been created, yet you can create it with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">kubectl create namespace kube-operators</code></pre>
</div>
</div>
<div class="paragraph">
<p>If not already configured, the command will also setup the YAKS custom resource definitions and roles
on the cluster (in this case, the user needs cluster-admin permissions).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Custom Resource Definitions (CRD) are cluster-wide objects and you need admin rights to install them. Fortunately, this
operation can be done <strong>once per cluster</strong>. So, if the <code>yaks install</code> operation fails, you&#8217;ll be asked to repeat it when logged as admin.
For Minishift, this means executing <code>oc login -u system:admin</code> then <code>yaks install --cluster-setup</code> only for the first-time installation.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="installation-global-mode"><a class="anchor" href="#installation-global-mode"></a><a class="link" href="#installation-global-mode">3.3.1. Global mode</a></h4>
<div class="paragraph">
<p>By default, the installation is using a <code>global</code> operator mode. This means that the operator
only lives once in your cluster watching for tests in all namespaces. A global operator uses cluster-roles
in order to manage tests in all namespaces.</p>
</div>
<div class="paragraph">
<p>When running on OpenShift the default namespace for global operators is <code>openshift-operators</code> (it is available by default). Be sure to
select this namespace when installing YAKS in the global mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks install -n openshift-operators</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="installation-namespaced-mode"><a class="anchor" href="#installation-namespaced-mode"></a><a class="link" href="#installation-namespaced-mode">3.3.2. Namespaced mode</a></h4>
<div class="paragraph">
<p>You can disable the <code>global</code> mode with a CLI setting when running the <code>install</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks install --global=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the non global <code>namespaced</code> mode the YAKS operator will only have the rights to create new tests in the same namespace as it is
running on. The operator will only watch for tests created in that the very same namespace.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Which mode to choose depends on your very specific needs. When you expect to have many tests in different namespaces that will
be recreated on a regular basis you may choose the global operator mode because you will not have to reinstall the operator many times.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you expect to have all tests in a single namespace or if you do not want to use cluster-wide operator permissions
for some reason you may want to switch the namespaced mode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Please also have a look at the <a href="#temporary-namespaces">temporary namespaces</a> section in this guide to make a decision on operator modes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installation-verify"><a class="anchor" href="#installation-verify"></a><a class="link" href="#installation-verify">3.4. Verify installation</a></h3>
<div class="paragraph">
<p>You can verify the installation by retrieving the custom resource definition provided in YAKS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">kubectl get customresourcedefinitions -l app=yaks</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">NAME                             CREATED AT
tests.yaks.citrusframework.org   2020-11-01T00:00:00Z</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following command will list all tests in your namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">kubectl get tests</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">NAME         PHASE    TOTAL   PASSED   FAILED   SKIPPED   ERRORS
helloworld   Passed   1       1        0        0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running"><a class="anchor" href="#running"></a><a class="link" href="#running">4. Running</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>After completing and verifying the <a href="installation" class="bare">installation</a> you can start running some tests.</p>
</div>
<div class="paragraph">
<p>You should be connected to your Kubernetes cluster and you should have the YAKS CLI tool available on your machine.</p>
</div>
<div class="paragraph">
<p>You can verify the proper YAKS CLI setup with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks version</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will print the YAKS version to the output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">YAKS ${project.version}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are now ready to run a first BDD test on the cluster. As a sample create a new feature file that prints some message
to the test output.</p>
</div>
<div class="listingblock">
<div class="title">helloworld.feature</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Feature: Hello

  Scenario: Print hello message
    Given print 'Hello from YAKS!'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You just need this single file to run the test on the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test helloworld.feature</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will be provided with the log output of the test and see the results:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>test "helloworld" created
+ test-helloworld › test
test-helloworld test INFO	|
test-helloworld test INFO	| ------------------------------------------------------------------------
test-helloworld test INFO	|        .__  __
test-helloworld test INFO	|   ____ |__|/  |________ __ __  ______
test-helloworld test INFO	| _/ ___\|  \   __\_  __ \  |  \/  ___/
test-helloworld test INFO	| \  \___|  ||  |  |  | \/  |  /\___ \
test-helloworld test INFO	|  \___  &gt;__||__|  |__|  |____//____  &gt;
test-helloworld test INFO	|      \/                           \/
test-helloworld test INFO	|
test-helloworld test INFO	| C I T R U S  T E S T S  3.0.0-M2
test-helloworld test INFO	|
test-helloworld test INFO	| ------------------------------------------------------------------------
test-helloworld test INFO	|
test-helloworld test
test-helloworld test Scenario: Print hello message    # org/citrusframework/yaks/helloworld.feature:3
test-helloworld test   Given print 'Hello from YAKS!' # org.citrusframework.yaks.standard.StandardSteps.print(java.lang.String)
test-helloworld test INFO	| ------------------------------------------------------------------------
test-helloworld test INFO	|
test-helloworld test INFO	| CITRUS TEST RESULTS
test-helloworld test INFO	|
test-helloworld test INFO	|  Print hello message ............................................ SUCCESS
test-helloworld test INFO	|
test-helloworld test INFO	| TOTAL:	1
test-helloworld test INFO	| FAILED:	0 (0.0%)
test-helloworld test INFO	| SUCCESS:	1 (100.0%)
test-helloworld test INFO	|
test-helloworld test INFO	| ------------------------------------------------------------------------
test-helloworld test
test-helloworld test 1 Scenarios (1 passed)
test-helloworld test 1 Steps (1 passed)
test-helloworld test 0m1.631s
test-helloworld test
test-helloworld test
Test Passed
Test results: Total: 1, Passed: 1, Failed: 0, Skipped: 0
	Print hello message (helloworld.feature:3): Passed</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, log levels are set to a minimum so you are not bothered with too much boilerplate output. You can increase log levels
with the command line option <code>--logger</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test helloworld.feature --logger root=INFO</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#logging">logging configuration</a> section in thi guide gives you some more details on this topic.</p>
</div>
<div class="paragraph">
<p>You are now ready to explore the different <a href="steps" class="bare">steps</a> that you can use in a feature file in order to connect with
various messaging transports as part of your test.</p>
</div>
<div class="sect2">
<h3 id="running-monitoring"><a class="anchor" href="#running-monitoring"></a><a class="link" href="#running-monitoring">4.1. Status monitoring</a></h3>
<div class="paragraph">
<p>As you run tests with YAKS you add tests to the current namespace. You can review the test status and monitor the
test results with the default Kubernetes CLI tool.</p>
</div>
<div class="paragraph">
<p>The following command will list all tests in your namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">kubectl get tests</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">NAME         PHASE    TOTAL   PASSED   FAILED   SKIPPED   ERRORS
helloworld   Passed   1       1        0        0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The overview includes the test outcome and outline the number of total scenarios that have been executed and the
test results for these scenarios (skipped, passed or failed). When a scenario has been failing the error message is also
displayed in this overview.</p>
</div>
<div class="paragraph">
<p>You can get more details of a single test with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">kubectl get test helloworld -o yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>This gets you the complete test details as a YAML file. You can then review status and detailed error messages.</p>
</div>
<div class="paragraph">
<p>Find out more about the individual test results and how to get reports (e.g. JUnit) from a test run in the
section about <a href="reporting" class="bare">reporting</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cli"><a class="anchor" href="#cli"></a><a class="link" href="#cli">5. Command line interface (yaks)</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The YAKS command line interface (yaks) is the main entry point for
installing the operator and for running tests on a Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>Releases of the CLI are available on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Github Releases: <a href="https://github.com/citrusfrmaework/yaks/releases" class="bare">https://github.com/citrusfrmaework/yaks/releases</a></p>
</li>
<li>
<p>Homebrew (Mac and Linux): <a href="https://formulae.brew.sh/formula/yaks" class="bare">https://formulae.brew.sh/formula/yaks</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="available-commands"><a class="anchor" href="#available-commands"></a><a class="link" href="#available-commands">5.1. Available Commands</a></h3>
<div class="paragraph">
<p>Some of the most used commands are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Useful Commands</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">help</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Obtain the full list of available commands</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yaks help</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Run a test on Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yaks test helloworld.feature</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The list above is not the full list of available commands. You can run <code>yaks help</code> to obtain the full list.
And each command also takes <code>--help</code> as parameter to output more information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test --help</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a><a class="link" href="#configuration">6. Configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are several runtime options that you can set in order to configure which tests to run for instance. Each test directory
can have its own <code>yaks-config.yaml</code> configuration file that holds the runtime options for this specific test suite.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">config:
  runtime:
    cucumber:
      tags:
      - "not @ignored"
      glue:
      - "org.citrusframework.yaks"
      - "com.company.steps.custom"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The sample above uses different runtime options for Cucumber to specify a tag filter and some custom glue packages that
should be loaded. The given runtime options will be set as environment variables in the YAKS runtime pod.</p>
</div>
<div class="paragraph">
<p>You can also specify the Cucumber options that get passed to the Cucumber runtime.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">config:
  runtime:
    cucumber:
      options: "--strict --monochrome --glue org.citrusframework.yaks"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also we can make use of command line options when using the <code>yaks</code> binary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test hello-world.feature --tag @regression --glue org.citrusframework.yaks</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="configuration-dependencies"><a class="anchor" href="#configuration-dependencies"></a><a class="link" href="#configuration-dependencies">6.1. Runtime dependencies</a></h3>
<div class="paragraph">
<p>The YAKS testing framework provides a base runtime image that holds all required libraries and artifacts to execute tests. You may need to add
additional runtime dependencies though in order to extend the framework capabilities.</p>
</div>
<div class="paragraph">
<p>For instance when using a Camel route in your test you may need to add additional Camel components that are not part in the
basic YAKS runtime (e.g. camel-groovy). You can add the runtime dependency to the YAKS runtime image in multiple ways:</p>
</div>
<div class="sect3">
<h4 id="configuration-tags"><a class="anchor" href="#configuration-tags"></a><a class="link" href="#configuration-tags">6.1.1. Cucumber tags</a></h4>
<div class="paragraph">
<p>You can simply add a tag to your BDD feature specification in order to declare a runtime dependency for your test.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">@require('org.apache.camel:camel-groovy:@camel.version@')
Feature: Camel route testing

  Background:
    Given Camel route hello.xml
    """
    &lt;route&gt;
      &lt;from uri="direct:hello"/&gt;
      &lt;filter&gt;
        &lt;groovy&gt;request.body.startsWith('Hello')&lt;/groovy&gt;
        &lt;to uri="log:org.citrusframework.yaks.camel?level=INFO"/&gt;
      &lt;/filter&gt;
      &lt;split&gt;
        &lt;tokenize token=" "/&gt;
        &lt;to uri="seda:tokens"/&gt;
      &lt;/split&gt;
    &lt;/route&gt;
    """

  Scenario: Hello route
    When send to route direct:hello body: Hello Camel!
    And receive from route seda:tokens body: Hello
    And receive from route seda:tokens body: Camel!</code></pre>
</div>
</div>
<div class="paragraph">
<p>The given Camel route uses the groovy language support and this is not part in the basic YAKS runtime image. So we add
the tag <code>@require('org.apache.camel:camel-groovy:@camel.version@')</code>. This tag will load the Maven dependency at runtime
before the test is executed in the YAKS runtime image.</p>
</div>
<div class="paragraph">
<p>Note that you have to provide proper Maven artifact coordinates with proper <code>groupId</code>, <code>artifactId</code> and <code>version</code>. You can make
use of version properties for these versions available in the YAKS base image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>citrus.version</p>
</li>
<li>
<p>camel.version</p>
</li>
<li>
<p>spring.version</p>
</li>
<li>
<p>cucumber.version</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuration-properties"><a class="anchor" href="#configuration-properties"></a><a class="link" href="#configuration-properties">6.1.2. System property or environment setting</a></h4>
<div class="paragraph">
<p>You can add dependencies also by specifying the dependencies as command line parameter when running the test via <code>yaks</code> CLI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test --dependency org.apache.camel:camel-groovy:@camel.version@ camel-route.feature</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will add a environment setting in the YAKS runtime container and the dependency will be loaded automatically
at runtime.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-properties-file"><a class="anchor" href="#configuration-properties-file"></a><a class="link" href="#configuration-properties-file">6.1.3. Property file</a></h4>
<div class="paragraph">
<p>YAKS supports adding runtime dependency information to a property file called <code>yaks.properties</code>. The dependency is added through
Maven coordinates in the property file using a common property key prefix <code>yaks.dependency.</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># include these dependencies
yaks.dependency.foo=org.foo:foo-artifact:1.0.0
yaks.dependency.bar=org.bar:bar-artifact:1.5.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add the property file when running the test via <code>yaks</code> CLI like follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test --settings yaks.properties camel-route.feature</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuration-file"><a class="anchor" href="#configuration-file"></a><a class="link" href="#configuration-file">6.1.4. YAKS configuration file</a></h4>
<div class="paragraph">
<p>When more dependencies are required to run a test you may consider to add a configuration file as <code>.yaml</code> or <code>.json</code>.</p>
</div>
<div class="paragraph">
<p>The configuration file is able to declare multiple dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">dependencies:
  - groupId: org.foo
    artifactId: foo-artifact
    version: 1.0.0
  - groupId: org.bar
    artifactId: bar-artifact
    version: 1.5.0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "dependencies": [
    {
      "groupId": "org.foo",
      "artifactId": "foo-artifact",
      "version": "1.0.0"
    },
    {
      "groupId": "org.bar",
      "artifactId": "bar-artifact",
      "version": "1.5.0"
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add the configuration file when running the test via <code>yaks</code> CLI like follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test --settings yaks.settings.yaml camel-route.feature</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-repositories"><a class="anchor" href="#configuration-repositories"></a><a class="link" href="#configuration-repositories">6.2. Maven repositories</a></h3>
<div class="paragraph">
<p>When adding custom runtime dependencies those artifacts might not be available on the public central Maven repository.
Instead you may need to add a custom repository that holds your artifacts.</p>
</div>
<div class="paragraph">
<p>You can do this with several configuration options:</p>
</div>
<div class="sect3">
<h4 id="configuration-repository-properties"><a class="anchor" href="#configuration-repository-properties"></a><a class="link" href="#configuration-repository-properties">6.2.1. System property or environment setting</a></h4>
<div class="paragraph">
<p>You can add repositories also by specifying the repositories as command line parameter when running the test via <code>yaks</code> CLI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test --maven-repository jboss-ea=https://repository.jboss.org/nexus/content/groups/ea/ my.feature</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will add a environment setting in the YAKS runtime container and the repository will be added to the Maven runtime project model.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-repository-file"><a class="anchor" href="#configuration-repository-file"></a><a class="link" href="#configuration-repository-file">6.2.2. Property file</a></h4>
<div class="paragraph">
<p>YAKS supports adding Maven repository information to a property file called <code>yaks.properties</code>. The dependency is added through
Maven repository id and url in the property file using a common property key prefix <code>yaks.repository.</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Maven repositories
yaks.repository.central=https://repo.maven.apache.org/maven2/
yaks.repository.jboss-ea=https://repository.jboss.org/nexus/content/groups/ea/</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add the property file when running the test via <code>yaks</code> CLI like follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test --settings yaks.properties my.feature</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuration-repository-config"><a class="anchor" href="#configuration-repository-config"></a><a class="link" href="#configuration-repository-config">6.2.3. YAKS configuration file</a></h4>
<div class="paragraph">
<p>More complex repository configuration might require to add a configuration file as <code>.yaml</code> or <code>.json</code>.</p>
</div>
<div class="paragraph">
<p>The configuration file is able to declare multiple repositories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">repositories:
  - id: "central"
    name: "Maven Central"
    url: "https://repo.maven.apache.org/maven2/"
    releases:
      enabled: "true"
      updatePolicy: "daily"
    snapshots:
      enabled: "false"
  - id: "jboss-ea"
    name: "JBoss Community Early Access Release Repository"
    url: "https://repository.jboss.org/nexus/content/groups/ea/"
    layout: "default"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "repositories": [
      {
        "id": "central",
        "name": "Maven Central",
        "url": "https://repo.maven.apache.org/maven2/",
        "releases": {
          "enabled": "true",
          "updatePolicy": "daily"
        },
        "snapshots": {
          "enabled": "false"
        }
      },
      {
        "id": "jboss-ea",
        "name": "JBoss Community Early Access Release Repository",
        "url": "https://repository.jboss.org/nexus/content/groups/ea/",
        "layout": "default"
      }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add the configuration file when running the test via <code>yaks</code> CLI like follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks test --settings yaks.settings.yaml my.feature</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-secrets"><a class="anchor" href="#configuration-secrets"></a><a class="link" href="#configuration-secrets">6.3. Using secrets</a></h3>
<div class="paragraph">
<p>Tests usually need to use credentials and connection URLs in order to connect to infrastructure components and services.
This might be sensitive data that should not go into the test configuration directly as hardcoded value. You should rather load the
credentials from a secret volume source.</p>
</div>
<div class="paragraph">
<p>To use the implicit configuration via secrets, we first need to create a configuration file holding the properties of a named configuration.</p>
</div>
<div class="listingblock">
<div class="title">mysecret.properties</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Only configuration related to the "mysecret" named config
database.url=jdbc:postgresql://syndesis-db:5432/sampledb
database.user=admin
database.password=special</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can create a secret from that file and label it so that it will be picked up automatically by the YAKS operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script"># Create the secret from the property file
kubectl create secret generic my-secret --from-file=mysecret.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the secret is created you can bind it to tests by their name. Given the test <code>my-test.feature</code> you can bind the secret to the test
by adding a label as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script"># Bind secret to the "my-test" test case
kubectl label secret my-secret yaks.citrusframework.org/test=my-test</code></pre>
</div>
</div>
<div class="paragraph">
<p>For multiple secrets and variants of secrets on different environments (e.g. dev, test, staging) you can add a secret id and label that one
explicitly in addition to the test name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script"># Bind secret to the named configuration "staging" of the "my-test" test case
kubectl label secret my-secret yaks.citrusframework.org/test=my-test yaks.citrusframework.org/test.configuration=staging</code></pre>
</div>
</div>
<div class="paragraph">
<p>With that in place you just need to set the secret id in your <code>yaks-config.yaml</code> for that test.</p>
</div>
<div class="listingblock">
<div class="title">yaks-config.yaml</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">config:
  runtime:
    secret: staging</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now write a test and use the secret properties as normal test variables:</p>
</div>
<div class="listingblock">
<div class="title">my-test.feature</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Feature: JDBC API

  Background:
    Given Database connection
      | url       | ${database.url} |
      | username  | ${database.user} |
      | password  | ${database.password} |</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="steps"><a class="anchor" href="#steps"></a><a class="link" href="#steps">7. Steps</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each line in a BDD feature file is backed by a step implementation that covers the actual runtime logic executed. YAKS
provides a set of step implementations that you can just out-of-the-box use in your feature file.</p>
</div>
<div class="paragraph">
<p>See the following step implementations that enable you to cover various areas of messaging and integration testing.</p>
</div>
<div class="sect2">
<h3 id="steps-standard"><a class="anchor" href="#steps-standard"></a><a class="link" href="#steps-standard">7.1. Standard steps</a></h3>
<div class="paragraph">
<p>The standard steps provide a lot of basic features and predefined steps that you can use to write feature files. Most of the steps aim
to leverage capabilities of the underlying test framework Citrus. For instance the steps are able to create Citrus test variables or print messages
to the output.</p>
</div>
<div class="sect3">
<h4 id="steps-variables"><a class="anchor" href="#steps-variables"></a><a class="link" href="#steps-variables">7.1.1. Variable steps</a></h4>
<div class="paragraph">
<p>Variables represent the fundamental concept to own test data throughout your test logic. Once a variable is created you can reference its value in
many steps and places in YAKS and Citrus. You could add a new identifier as a variable and reference this in many places
such as message headers, body content, SQL statements and many more.</p>
</div>
<div class="listingblock">
<div class="title">create variable</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Given variable orderId is "1001"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create the variable <code>orderId</code> in the current test context. All subsequent steps and operations may reference the variable with the expression <code>${orderId}</code>.
Citrus makes sure to replace the variable placeholder with its actual value before sending out messages and before validating incoming messages. As already mentioned
you can use the variable placeholder expression in many places such as message headers and body content:</p>
</div>
<div class="listingblock">
<div class="title">json payload</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "id": "${orderId}",
  "name": "Watermelon",
  "amount": 10
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can create multiple variables in one single step using:</p>
</div>
<div class="listingblock">
<div class="title">creating variables</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Given variables
  | orderId  | 1001      |
  | name     | Pineapple |</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="steps-log"><a class="anchor" href="#steps-log"></a><a class="link" href="#steps-log">7.1.2. Log steps</a></h4>
<div class="paragraph">
<p>Logging a message to the output can be helpful in terms of debugging and/or to give information about the context of an operation.</p>
</div>
<div class="paragraph">
<p>YAKS provides following steps to add log output:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Step</th>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print '&lt;any text&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any text that should be printed to the output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Printing messages to the output. Supports variables and functions in text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log '&lt;any text&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any text that should be logged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log messages to the output. Supports variables and functions in text.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">print/log messages</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">  Scenario: log messages
    Then print 'YAKS rocks!'

  Scenario: multiline log messages
    Given print
    """
    Hello users!

    YAKS provides Cloud Native BDD testing on Kubernetes!
    """</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="steps-sleep"><a class="anchor" href="#steps-sleep"></a><a class="link" href="#steps-sleep">7.1.3. Sleep</a></h4>
<div class="paragraph">
<p>The <code>sleep</code> step lets the test run wait for a given amount of time (in milliseconds). During the sleep no action will be performed and the subsequent steps are postponed respectively.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Step</th>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sleep</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sleep the default time of 5000 milliseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sleep &lt;time&gt; ms</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">time in milliseconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sleep given amount of time in milliseconds.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">sleep</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">  Scenario: sleep time period
    Then sleep 2500 ms</code></pre>
</div>
</div>
<div class="paragraph">
<p>The step receives a numeric parameter that represents the amount of time (in milliseconds) to wait.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The Citrus framework also provides a set of BDD step implementations that you can use in a feature file. Read more about the available steps
(e.g. for connecting with Selenium) in the official <a href="https://citrusframework.org/citrus/reference/2.8.0/html/index.html#cucumber">Citrus documentation on BDD testing</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="steps-camel"><a class="anchor" href="#steps-camel"></a><a class="link" href="#steps-camel">7.2. Apache Camel steps</a></h3>
<div class="paragraph">
<p>ToDo</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-camel-k"><a class="anchor" href="#steps-camel-k"></a><a class="link" href="#steps-camel-k">7.3. Apache Camel K steps</a></h3>
<div class="paragraph">
<p>If the subject under test is a Camel K integration, you can leverage the YAKS Camel K bindings
that provide useful steps for checking the status of integrations.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">   ...
   Given integration xxx is running
   Then integration xxx should print Hello world!</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Camel K extension library is provided by default in YAKS.</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-groovy"><a class="anchor" href="#steps-groovy"></a><a class="link" href="#steps-groovy">7.4. Groovy steps</a></h3>
<div class="paragraph">
<p>The Groovy support in YAKS allows to add framework configuration, bean configuration and test actions via script snippets.
In particular you can easily add customized endpoints that send/receive data over various messaging transports.</p>
</div>
<div class="sect3">
<h4 id="groovy-configuration-script"><a class="anchor" href="#groovy-configuration-script"></a><a class="link" href="#groovy-configuration-script">7.4.1. Framework configuration</a></h4>
<div class="paragraph">
<p>You can add endpoints and beans as Citrus framework configuration like follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Endpoint script config
  Given URL: http://localhost:18080
  Given create configuration
  """
  citrus {
      endpoints {
          http {
              server('helloServer') {
                  port = 18080
                  autoStart = true
              }
          }
      }
  }
  """
  When send GET /hello
  Then receive HTTP 200 OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above the scenario creates a new Citrus endpoint named <code>helloServer</code> with given properties (<code>port</code>, <code>autoStart</code>) in form of a Groovy configuration script.
The endpoint is a Http server component that is automatically started with the given port. In the following the scenario can send messages to that server endpoint.</p>
</div>
<div class="paragraph">
<p>The Groovy configuration script adds Citrus components to the test context and supports following elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>endpoints</code>: Configure Citrus endpoint components that can be used to exchange data over various messaging transports</p>
</li>
<li>
<p><code>queues</code>: In memory queues to handle message forwarding for incoming messages</p>
</li>
<li>
<p><code>beans</code>: Custom beans configuration (e.g. data source, SSL context, request factory) that can be used in Citrus endpoint components</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s quickly have a look at a bean configuration where a new JDBC data source is added to the test suite.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Bean configuration
  Given create configuration
  """
  citrus {
      beans {
          dataSource(org.apache.commons.dbcp2.BasicDataSource) {
              driverClassName = "org.h2.Driver"
              url = "jdbc:h2:mem:camel"
              username = "sa"
              password = ""
          }
      }
  }
  """</code></pre>
</div>
</div>
<div class="paragraph">
<p>The data source will be added as a bean named <code>dataSource</code> and can be referenced in all Citrus SQL test actions.</p>
</div>
<div class="paragraph">
<p>All Groovy configuration scripts that we have seen so far can also be loaded from external file resources, too.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Endpoint script config
  Given load configuration citrus.configuration.groovy
  When endpoint hello sends payload Hello from new direct endpoint!
  Then endpoint hello should receive payload Hello from new direct endpoint!</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">citrus.configuration.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code>citrus {
    queues {
        queue('say-hello')
    }

    endpoints {
        direct {
            asynchronous {
                name = 'hello'
                queue = 'say-hello'
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="groovy-endpoint-script"><a class="anchor" href="#groovy-endpoint-script"></a><a class="link" href="#groovy-endpoint-script">7.4.2. Endpoint configuration</a></h4>
<div class="paragraph">
<p>Endpoints describe an essential part in terms of messaging integration during a test. There are multiple ways to add custom endpoints
to a test so you exchange and verify message data. Endpoint Groovy scripts is one comfortable way to add custom endpoint configurations
in a test scenario.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Create Http endpoint
  Given URL: http://localhost:18081
  Given create endpoint helloServer.groovy
  """
  http()
    .server()
    .port(18081)
    .autoStart(true)
  """
  When send GET /hello
  Then receive HTTP 200 OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>The scenario creates a new Http server endpoint named <code>helloServer</code>. This server component can be used directly in the
scenario to receive and verify messages sent to that endpoint.</p>
</div>
<div class="paragraph">
<p>You can also load the endpoint configuration from external file resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Load endpoint
  Given URL: http://localhost:18088
  Given load endpoint fooServer.groovy
  When send GET /hello
  Then receive HTTP 200 OK
`----

.fooServer.groovy
[source]</code></pre>
</div>
</div>
<div class="paragraph">
<p>http()
    .server()
    .port(18088)
    .autoStart(true)
``----</p>
</div>
</div>
<div class="sect3">
<h4 id="groovy-action-script"><a class="anchor" href="#groovy-action-script"></a><a class="link" href="#groovy-action-script">7.4.3. Test actions</a></h4>
<div class="paragraph">
<p>YAKS provides a huge set of predefined test actions that users can add to the Gherkin feature files out of the box.
However there might be situations where you want to run a customized test action code as a step in your feature scenario.</p>
</div>
<div class="paragraph">
<p>With the Groovy script support in YAKS you can add such customized test actions via script snippets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Custom test actions
  Given create actions basic.groovy
  """
  actions {
    echo('Hello from Groovy script')
    sleep().seconds(1)

    createVariables()
        .variable('foo', 'bar')

    echo('Variable foo=${foo}')
  }
  """
  Then apply basic.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Users familiar with Citrus will notice immediately that the action script is using the Citrus actions DSL to describe
what should be done when running the Groovy script as part of the test. The Citrus action DSL is quite powerful and allows to
perform complex actions such as iterations, conditionals and send/receive operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Messaging actions
  Given create actions messaging.groovy
  """
  actions {
    send('direct:myQueue')
      .payload('Hello from Groovy script!')

    receive('direct:myQueue')
      .payload('Hello from Groovy script!')
  }
  """
  Then apply messaging.groovy</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="steps-http"><a class="anchor" href="#steps-http"></a><a class="link" href="#steps-http">7.5. Http steps</a></h3>
<div class="paragraph">
<p>The Http protocol is a widely used communication protocol when it comes to exchanging data between systems. REST Http services
are very prominent and producing/consuming those services is a common task in software development these days. YAKS provides
ready to use steps that are able to exchange request/response messages via Http during the test.</p>
</div>
<div class="paragraph">
<p>As a client you can specify the server URL and send requests to it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Feature: Http client

  Background:
    Given URL: http://localhost:8080

  Scenario: Health check
    Given path /health is healthy

  Scenario: GET request
    When send GET /todo
    Then verify HTTP response body: {"id": "@ignore@", "task": "Sample task", "completed": 0}
    And receive HTTP 200 OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above sets a base request URL to <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code> and performs a health check on path <code>/health</code>. After that we can
send any request to the server and verify the response body and status code.</p>
</div>
<div class="paragraph">
<p>All these steps are part of the core YAKS framework and you can just use them.</p>
</div>
<div class="paragraph">
<p>On the server side we can start a new Http server instance on a given port and listen for incoming requests. These request can be verified and
the test can provide a simulated response message with body and header data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Feature: Http server

  Background:
    Given HTTP server listening on port 8080

  Scenario: Expect GET request
    When receive GET /todo
    Then HTTP response body:  {"id": 1000, "task": "Sample task", "completed": 0}
    And send HTTP 200 OK

  Scenario: Expect POST request
    Given expect HTTP request body: {"id": "@isNumber()@", "task": "New task", "completed": "@matches(0|1)@"}
    When receive POST /todo
    Then send HTTP 201 CREATED</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the HTTP server sample above we create a new server instance listening on port <code>8080</code>. Then we expect a <code>GET</code> request on path <code>/todo</code>. The server responds with
a Http <code>200 OK</code> response message and given Json body as payload.</p>
</div>
<div class="paragraph">
<p>The second scenario expects a POST request with a given body as Json payload. The expected request payload is verified with the powerful Citrus JSON
message validator being able to compare JSON tree structures in combination with validation matchers such as <code>isNumber()</code> or <code>matches(0|1)</code>.</p>
</div>
<div class="paragraph">
<p>Once the request is verified the server responds with a simple Http <code>201 CREATED</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-jdbc"><a class="anchor" href="#steps-jdbc"></a><a class="link" href="#steps-jdbc">7.6. JDBC steps</a></h3>
<div class="paragraph">
<p>YAKS provides a library that allows to execute SQL actions on relational DBs (limited to PostgreSQL for this POC).</p>
</div>
<div class="paragraph">
<p>You can find examples of JDBC steps in the <a href="../../examples/jdbc/jdbc.feature">examples</a> file.</p>
</div>
<div class="paragraph">
<p>There&#8217;s also an example that uses <a href="../../examples/openapi/task-api.feature">JDBC and REST together</a> and targets the
<a href="https://github.com/syndesisio/todo-example">Syndesis TODO App</a> database.</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-jms"><a class="anchor" href="#steps-jms"></a><a class="link" href="#steps-jms">7.7. JMS steps</a></h3>
<div class="paragraph">
<p>ToDo</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-kafka"><a class="anchor" href="#steps-kafka"></a><a class="link" href="#steps-kafka">7.8. Kafka steps</a></h3>
<div class="paragraph">
<p>ToDo</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-kubernetes"><a class="anchor" href="#steps-kubernetes"></a><a class="link" href="#steps-kubernetes">7.9. Kubernetes steps</a></h3>
<div class="paragraph">
<p>ToDo</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-knative"><a class="anchor" href="#steps-knative"></a><a class="link" href="#steps-knative">7.10. Knative steps</a></h3>
<div class="paragraph">
<p>ToDo</p>
</div>
</div>
<div class="sect2">
<h3 id="steps-openapi"><a class="anchor" href="#steps-openapi"></a><a class="link" href="#steps-openapi">7.11. Open API steps</a></h3>
<div class="paragraph">
<p>OpenAPI documents specify RESTful Http services in a standardized, language-agnostic way. The specifications describe
resources, path items, operations, security schemes and many more components that are part of the REST service. YAKS as a
framework is able to use these information in order to generate proper request and response data for your test.</p>
</div>
<div class="paragraph">
<p>You can find examples of how to use OpenAPI specifications in YAKS in the <a href="#../../examples/openapi">examples</a>.</p>
</div>
<div class="paragraph">
<p>Given an OpenAPI specification that you can access via Http URL or local file system you can load all available operations
into the test. Once this is completed you can invoke operations by name and verify the response status codes. YAKS will automatically
generate proper request/response data for you.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Feature: Petstore API V3

  Background:
    Given OpenAPI specification: http://localhost:8080/petstore/v3/openapi.json

  Scenario: getPet
    When invoke operation: getPetById
    Then verify operation result: 200 OK

  Scenario: petNotFound
    Given variable petId is "0"
    When invoke operation: getPetById
    Then verify operation result: 404 NOT_FOUND

  Scenario: addPet
    When invoke operation: addPet
    Then verify operation result: 201 CREATED

  Scenario: updatePet
    When invoke operation: updatePet
    Then verify operation result: 200 OK

  Scenario: deletePet
    When invoke operation: deletePet
    Then verify operation result: 204 NO_CONTENT</code></pre>
</div>
</div>
<div class="paragraph">
<p>The request/response data is generated from the OpenAPI specification rules and holds randomized values. The following sample  shows a generated
request for the <code>addPet</code> operation where a new pet is transmitted via Http POST.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "photoUrls": [
    "XHAGIyFcyh"
  ],
  "name": "mGNTgkfxgg",
  "id": 26866048,
  "category": {
    "name": "konwOUYwMo",
    "id": 18676332
  },
  "tags": [
    {
      "name": "KDnoWCfUBn",
      "id": 31444049
    }
  ],
  "status": "sold"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The generated request should be valid according to the rules in the OpenAPI specification. You can overwrite the
randomized values with test variables and inbound/outbound data dictionaries in order to have more human readable test data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Feature: Petstore API V3

  Background:
    Given OpenAPI specification: http://localhost:8080/petstore/v3/openapi.json
    Given variable petId is "citrus:randomNumber(5)"
    Given inbound dictionary
      | $.name          | @assertThat(anyOf(is(hasso),is(cutie),is(fluffy)))@ |
      | $.category.name | @assertThat(anyOf(is(dog),is(cat),is(fish)))@ |
    Given outbound dictionary
      | $.name          | citrus:randomEnumValue('hasso','cutie','fluffy') |
      | $.category.name | citrus:randomEnumValue('dog', 'cat', 'fish') |

  [...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this data dictionaries in place the generated request looks like follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "photoUrls": [
    "aaKoEDhLYc"
  ],
  "name": "hasso",
  "id": 12337393,
  "category": {
    "name": "cat",
    "id": 23927231
  },
  "tags": [
    {
      "name": "FQxvuCbcqT",
      "id": 58291150
    }
  ],
  "status": "pending"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see that we are now using more human readable values for <code>$.name</code> and <code>$.category.name</code>.</p>
</div>
<div class="paragraph">
<p>The same mechanism applies for inbound messages that are verified by YAKS. The framework will generate an expected response
data structure coming from the OpenAPI specification. Below is a sample Json payload that verifies the response for the <code>getPetById</code> operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "photoUrls": "@ignore@",
  "name": "@assertThat(anyOf(is(hasso),is(cutie),is(fluffy)))@",
  "id": "@isNumber()@",
  "category": {
    "name": "@assertThat(anyOf(is(dog),is(cat),is(fish)))@",
    "id": "@isNumber()@"
  },
  "tags": "@ignore@",
  "status": "@matches(available|pending|sold)@"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All mandatory fields need to be in the received json document. Also enumerations and number values are checked to meet the expected
values coming form the OpenAPI specification (e.g. <code>status=@matches(available|pending|sold)@</code>). This ensures that the response respects the rules
defined in the specification.</p>
</div>
<div class="paragraph">
<p>In case you also want to validate the exact values on each field please use the generic Http steps where you can provide a complete expected
Http response with payload and header data.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extensions"><a class="anchor" href="#extensions"></a><a class="link" href="#extensions">8. Extensions</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="extensions-minio"><a class="anchor" href="#extensions-minio"></a><a class="link" href="#extensions-minio">8.1. Minio upload</a></h3>
<div class="paragraph">
<p>Extensions add custom steps to the test runtime so you can use custom step definitions in your feature file.</p>
</div>
<div class="listingblock">
<div class="title">extension.feature</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: print extended slogan
    Given YAKS does Cloud-Native BDD testing
    Then YAKS can be extended!</code></pre>
</div>
</div>
<div class="paragraph">
<p>The step <code>YAKS can be extended!</code> is not available in the default step implementations provided by YAKS. The step definition
is implemented in a separate custom Maven module and gets uploaded to the Kubernetes cluster using the
<a href="https://github.com/container-tools/snap">container-tools/snap</a> library.</p>
</div>
<div class="paragraph">
<p>Snap uses a <a href="https://min.io/">Minio</a> object storage that is automatically installed in the current namespace. You can build and upload
custom Maven modules with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">$ yaks upload examples/extensions/steps</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create the Minio storage and perform the upload. After that you can use the custom steps in your feature file. Be sure to add
the dependency and the additional glue code in <code>yaks-config.yaml</code>.</p>
</div>
<div class="listingblock">
<div class="title">yaks-config.yaml</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">config:
  runtime:
    cucumber:
      glue:
      - "org.citrusframework.yaks"
      - "com.company.steps.custom"
dependencies:
  - groupId: com.company
    artifactId: steps
    version: "1.0.0-SNAPSHOT"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The additional glue code should match the package name where to find the custom step definitions in your custom code.</p>
</div>
<div class="paragraph">
<p>With that you are all set and can run the test as usual:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">$ yaks test extension.feature</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use the upload as part of the test command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">$ yaks test extension.feature --upload steps</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--upload</code> option builds and uploads the custom Maven module automatically before the test.</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-jitpack"><a class="anchor" href="#extensions-jitpack"></a><a class="link" href="#extensions-jitpack">8.2. Jitpack extensions</a></h3>
<div class="paragraph">
<p>Jitpack allows you to load custom steps from an external GitHub repository in order to use
custom step definitions in your feature file.</p>
</div>
<div class="listingblock">
<div class="title">jitpack.feature</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gherkin">Scenario: Use custom steps
    Given My steps are loaded
    Then I can do whatever I want!</code></pre>
</div>
</div>
<div class="paragraph">
<p>The steps <code>My steps are loaded</code> and <code>I can do whatever I want!</code> live in a separate repository on
GitHub ([<a href="https://github.com/citrusframework/yaks-step-extension" class="bare">https://github.com/citrusframework/yaks-step-extension</a>](<a href="https://github.com/citrusframework/yaks-step-extension)" class="bare">https://github.com/citrusframework/yaks-step-extension)</a>).</p>
</div>
<div class="paragraph">
<p>We need to add the Jitpack Maven repository, the dependency and the additional glue code in the <code>yaks-config.yaml</code>.</p>
</div>
<div class="listingblock">
<div class="title">yaks-config.yaml</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">config:
  runtime:
    cucumber:
      glue:
      - "org.citrusframework.yaks"
      - "dev.yaks.testing.standard"
    settings:
      repositories:
        - id: "central"
          name: "Maven Central"
          url: "https://repo.maven.apache.org/maven2/"
        - id: "jitpack.io"
          name: "JitPack Repository"
          url: "https://jitpack.io"
      dependencies:
        - groupId: com.github.citrusframework
          artifactId: yaks-step-extension
          version: "0.0.1"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The additional glue code <code>dev.yaks.testing.standard</code> should match the package name where to find the custom step definitions in the library. The Jitpack
Maven repository makes sure the library gets resolved at runtime.</p>
</div>
<div class="paragraph">
<p>With that you are all set and can run the test as usual:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">$ yaks test jitpack.feature</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the logs you will see that Jitpack automatically loads the additional dependency before the test.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pre-post-scripts"><a class="anchor" href="#pre-post-scripts"></a><a class="link" href="#pre-post-scripts">9. Pre/Post scripts</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can run scripts before/after a test group. Just add your commands to the <code>yaks-config.yaml</code> configuration for the test group.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">config:
  namespace:
    temporary: false
    autoRemove: true
pre:
  - script: prepare.sh
  - run: echo Start!
  - name: Optional name
    timeout: 30m
    run: |
      echo "Multiline"
      echo "Commands are also"
      echo "Supported!"
post:
  - script: finish.sh
  - run: echo Bye!</code></pre>
</div>
</div>
<div class="paragraph">
<p>The section <code>pre</code> runs before a test group and <code>post</code> is added after the test group has finished. The post steps are run even if the tests or pre steps fail
for some reason. This ensures that cleanup tasks are performed also in case of errors.</p>
</div>
<div class="paragraph">
<p>The <code>script</code> option provides a file path to bash script to execute. The user has to make sure that the script is executable. If no absolute file path is
given it is assumed to be a file path relative to the current test group directory.</p>
</div>
<div class="paragraph">
<p>With <code>run</code> you can add any shell command. At the moment only single line commands are supported here. You can add multiple <code>run</code> commands in a <code>pre</code>
or <code>post</code> section.</p>
</div>
<div class="paragraph">
<p>Each step can also define a human readable <code>name</code> that will be printed before its execution.</p>
</div>
<div class="paragraph">
<p>By default a step must complete within 30 minutes (<code>30m</code>). The timeout can be changed using the <code>timeout</code> option in the step declaration (in Golang duration format).</p>
</div>
<div class="paragraph">
<p>Scripts can leverage the following environment variables that are set automatically by the Yaks runtime:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>YAKS_NAMESPACE</strong>: always contains the namespace where the tests will be executed, no matter if the namespace is fixed or temporary</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reports"><a class="anchor" href="#reports"></a><a class="link" href="#reports">10. Reporting</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>After running some YAKS tests you may want to review the test results and generate a summary report. As we are using CRDs on the Kubernetes or OpenShift platform we
can review the status of the custom resources after the test run in order to get some test results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">oc get tests

NAME         PHASE     TOTAL     PASSED    FAILED    SKIPPED
helloworld   Passed    2         2         0         0
foo-test     Passed    1         1         0         0
bar-test     Passed    1         1         0         0</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also view error details when adding the <code>wide</code> option</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">oc get tests -o wide

NAME         PHASE     TOTAL     PASSED    FAILED    SKIPPED    ERRORS
helloworld   Passed    2         1         1         0          [ "helloworld.feature:10 Failed caused by ValidationException - Expected 'foo' but was 'bar'" ]
foo-test     Passed    1         1         0         0
bar-test     Passed    1         1         0         0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The YAKS CLI is able to fetch those results in order to generate a summary report locally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks report --fetch

Test results: Total: 4, Passed: 4, Failed: 0, Skipped: 0
	classpath:org/citrusframework/yaks/helloworld.feature:3: Passed
	classpath:org/citrusframework/yaks/helloworld.feature:7: Passed
	classpath:org/citrusframework/yaks/foo-test.feature:3: Passed
	classpath:org/citrusframework/yaks/bar-test.feature:3: Passed</code></pre>
</div>
</div>
<div class="paragraph">
<p>The report supports different output formats (summary, json, junit). For JUnit style reports use the <code>junit</code> output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks report --fetch --output junit

&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;testsuite name="org.citrusframework.yaks.JUnitReport" errors="0" failures="0" skipped="0" tests="4" time="0"&gt;
  &lt;testcase name="helloworld.feature:3" classname="classpath:org/citrusframework/yaks/helloworld.feature:3" time="0"&gt;&lt;/testcase&gt;
  &lt;testcase name="helloworld.feature:7" classname="classpath:org/citrusframework/yaks/helloworld.feature:7" time="0"&gt;&lt;/testcase&gt;
  &lt;testcase name="foo-test.feature:3" classname="classpath:org/citrusframework/yaks/foo-test.feature:3" time="0"&gt;&lt;/testcase&gt;
  &lt;testcase name="bar-test.feature:3" classname="classpath:org/citrusframework/yaks/bar-test.feature:3" time="0"&gt;&lt;/testcase&gt;
&lt;/testsuite&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JUnit report is also saved to the local disk in the file <code>_output/junit-reports.xml</code>.</p>
</div>
<div class="paragraph">
<p>The <code>_output</code> directory is also used to store individual test results for each test executed via the YAKS CLI.
So after a test run you can also review the results in that <code>_output</code> directory. The YAKS report command can also view those results in <code>_output</code> directory
in any given output format. Simply leave out the <code>--fetch</code> option when generating the report and YAKS will use the test results stored in the
local <code>_output</code> folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks report
Test results: Total: 5, Passed: 5, Failed: 0, Skipped: 0
	classpath:org/citrusframework/yaks/helloworld.feature:3: Passed
	classpath:org/citrusframework/yaks/helloworld.feature:7: Passed
	classpath:org/citrusframework/yaks/test1.feature:3: Passed
	classpath:org/citrusframework/yaks/test2.feature:3: Passed
	classpath:org/citrusframework/yaks/test3.feature:3: Passed</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing"><a class="anchor" href="#contributing"></a><a class="link" href="#contributing">11. Contributing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go 1.13+</p>
</li>
<li>
<p>Operator SDK 0.19.4+</p>
</li>
<li>
<p>Maven 3.6.2+</p>
</li>
<li>
<p>Git client</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can build the YAKS project and get the <code>yaks</code> CLI by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">make build</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to build the operator image locally for development in Minishift for instance, then:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script"># Build binaries and images
eval $(minishift docker-env)
make clean images-no-test</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operator pod is running, just delete it to let it grab the new image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">oc delete pod yaks</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="uninstall"><a class="anchor" href="#uninstall"></a><a class="link" href="#uninstall">12. Uninstall</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In case you really need to remove YAKS and all related resources from Kubernetes or OpenShift you can do so with the
following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks uninstall</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will remove the YAKS operator from the current namespace along with all related custom resource definitions.</p>
</div>
<div class="paragraph">
<p>When using the global operator mode you may need to select the proper namespace here.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks uninstall -n kube-operators</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, the uninstall will <strong>not</strong> remove resources that are possibly shared between namespaces and clusters (e.g. CRDs and roles).
Please use the <code>--all</code> flag if you need to wipe out these, too.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks uninstall -n kube-operators --all</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--all</code> option removes the operator and all related resources such as <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources">CustomResourceDefinitions (CRD)</a> and
<a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac">ClusterRole</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
In case the operator has <strong>not</strong> been installed via <a href="https://docs.openshift.com/container-platform/4.1/applications/operators/olm-understanding-olm.html">Operator Lifecycle Manager(OLM)</a> you may need to
use the option <code>--olm=false</code> also when uninstalling. In particular this is the case when installing YAKS from sources on <a href="https://code-ready.github.io/crc/">CRC</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell script">yaks uninstall --olm=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use this whenever you do not want to use OLM framework for performing the uninstall.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="samples"><a class="anchor" href="#samples"></a><a class="link" href="#samples">13. Samples</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>ToDo</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.2.0-SNAPSHOT<br>
Last updated 2020-11-27 11:30:54 +0100
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
<style>
  #footer-sponsor {
    position: absolute;
    bottom: 5px;
    right: 25px;
    float: right;
  }
</style>
<div id="footer-sponsor">
</div>
</body>
</html>